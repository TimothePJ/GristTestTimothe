<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <title>onRecords</title>
    <script src="https://docs.getgrist.com/grist-plugin-api.js"></script>
  </head>
  <body>
    <label for="firstColumnDropdown">Select from first column:</label>
    <select id="firstColumnDropdown">
      <option value="">Select an option</option>
    </select>

    <script>
      // Ready Grist
      grist.ready();
      
      // Listen for record updates
      grist.onRecords(function(records) {
        // Extract the first column values (assuming 'NomProjet' is the first column)
        const firstColumnValues = [...new Set(records.map(record => record.NomProjet))];
        
        // Populate the dropdown with the unique values from the first column
        populateFirstColumnDropdown(firstColumnValues);
      });

      function populateFirstColumnDropdown(values) {
        const dropdown = document.getElementById('firstColumnDropdown');
        
        // Clear existing options
        dropdown.innerHTML = '<option value="">Select an option</option>';
        
        // Populate dropdown with new options
        values.forEach(value => {
          const option = document.createElement('option');
          option.value = value;
          option.text = value;
          dropdown.appendChild(option);
        });
      }
    </script>
  </body>
</html>
